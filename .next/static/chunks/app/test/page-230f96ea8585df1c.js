(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{72:(e,r,t)=>{"use strict";t.d(r,{default:()=>R});var s=t(5155),a=t(2115),n=t(7192),o=t(7202),c=t(5572),l=t(9160);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,l.QP)((0,c.$)(r))}let d=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:i(d({variant:t}),r),...a})}let h=a.forwardRef((e,r)=>{let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n})});h.displayName="Input";var f=t(6671);class p extends Error{constructor(e,r){super(r),this.status=e,this.name="APIError"}}async function m(e){if(!e.ok){let r=await e.json().catch(()=>({error:"Une erreur inconnue est survenue"}));throw new p(e.status,r.error||"Une erreur est survenue")}return e.json()}let g={getAll:async()=>{try{let e=await fetch("/api/tags");return m(e)}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des tags:",e),f.oR.error("Impossible de r\xe9cup\xe9rer les tags"),e}},create:async e=>{try{let r=await fetch("/api/tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return m(r)}catch(e){throw console.error("Erreur lors de la cr\xe9ation du tag:",e),f.oR.error("Impossible de cr\xe9er le tag"),e}},delete:async e=>{try{let r=await fetch("/api/tags?id=".concat(e),{method:"DELETE"});return m(r)}catch(e){throw console.error("Erreur lors de la suppression du tag:",e),f.oR.error("Impossible de supprimer le tag"),e}}},x={getByTache:async e=>{try{let r=await fetch("/api/sous-taches?tacheId=".concat(e));return m(r)}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des sous-t\xe2ches:",e),f.oR.error("Impossible de r\xe9cup\xe9rer les sous-t\xe2ches"),e}},create:async e=>{try{let r=await fetch("/api/sous-taches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return m(r)}catch(e){throw console.error("Erreur lors de la cr\xe9ation de la sous-t\xe2che:",e),f.oR.error("Impossible de cr\xe9er la sous-t\xe2che"),e}},update:async(e,r)=>{try{let t=await fetch("/api/sous-taches?id=".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return m(t)}catch(e){throw console.error("Erreur lors de la mise \xe0 jour de la sous-t\xe2che:",e),f.oR.error("Impossible de mettre \xe0 jour la sous-t\xe2che"),e}},delete:async e=>{try{let r=await fetch("/api/sous-taches?id=".concat(e),{method:"DELETE"});return m(r)}catch(e){throw console.error("Erreur lors de la suppression de la sous-t\xe2che:",e),f.oR.error("Impossible de supprimer la sous-t\xe2che"),e}}};function y(e){let{className:r,size:t="md"}=e;return(0,s.jsx)("div",{className:i("animate-spin rounded-full border-2 border-current border-t-transparent",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[t],r)})}let v=e=>{let{selectedTags:r=[],onTagsChange:t,placeholder:o="Ajouter un tag...",maxTags:c=10}=e,[l,i]=(0,a.useState)(""),{tags:d,isLoading:p,error:m,createTag:x}=function(){let[e,r]=(0,a.useState)([]),[t,s]=(0,a.useState)(!0),[n,o]=(0,a.useState)(null),c=(0,a.useCallback)(async()=>{try{s(!0),o(null);let e=await g.getAll();r(e)}catch(e){o(e instanceof Error?e:Error("Une erreur est survenue"))}finally{s(!1)}},[]);return(0,a.useEffect)(()=>{c()},[c]),{tags:e,isLoading:t,error:n,refresh:c,createTag:async e=>{try{let t=await g.create(e);return r(e=>[...e,t]),f.oR.success("Tag cr\xe9\xe9 avec succ\xe8s"),t}catch(e){throw e}},deleteTag:async e=>{try{await g.delete(e),r(r=>r.filter(r=>r.id!==e)),f.oR.success("Tag supprim\xe9 avec succ\xe8s")}catch(e){throw e}}}}(),v=d.filter(e=>r.includes(e.id)),b=async e=>{"Enter"===e.key||","===e.key?(e.preventDefault(),await j()):"Backspace"===e.key&&!l&&r.length>0&&w(r[r.length-1])},j=async()=>{let e=l.trim().toLowerCase();if(!e||r.length>=c)return;let s=d.find(r=>r.nom.toLowerCase()===e);try{if(s)r.includes(s.id)||t([...r,s.id]);else{let s=await x({nom:e});t([...r,s.id])}i("")}catch(e){console.error("Erreur lors de la cr\xe9ation du tag:",e)}},w=e=>{t(r.filter(r=>r!==e))};return p?(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(y,{})}):m?(0,s.jsx)("div",{className:"text-red-500 p-4",children:"Une erreur est survenue lors du chargement des tags"}):(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:v.map(e=>(0,s.jsxs)(u,{variant:"secondary",className:"flex items-center gap-1 px-2 py-1",style:e.couleur?{backgroundColor:e.couleur}:void 0,children:[e.nom,(0,s.jsx)("button",{type:"button",onClick:()=>w(e.id),className:"hover:text-destructive",children:(0,s.jsx)(n.A,{className:"h-3 w-3"})})]},e.id))}),(0,s.jsx)(h,{type:"text",value:l,onChange:e=>i(e.target.value),onKeyDown:b,onBlur:()=>j(),placeholder:r.length<c?o:"Nombre maximum de tags atteint",disabled:r.length>=c,className:"w-full"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Appuyez sur Entr\xe9e ou utilisez une virgule pour ajouter un tag"})]})};var b=t(6336),j=t(1684);let w=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(b.bL,{ref:r,className:i("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,s.jsx)(b.C1,{className:i("flex items-center justify-center text-current"),children:(0,s.jsx)(j.A,{className:"h-4 w-4"})})})});w.displayName=b.bL.displayName;var N=t(5868);let k=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=a.forwardRef((e,r)=>{let{className:t,variant:a,size:n,asChild:o=!1,...c}=e,l=o?N.DX:"button";return(0,s.jsx)(l,{className:i(k({variant:a,size:n,className:t})),ref:r,...c})});E.displayName="Button";var C=t(3184);let T=e=>{let{tacheId:r}=e,[t,o]=(0,a.useState)(""),{sousTaches:c,isLoading:l,error:i,createSousTache:d,toggleSousTache:u,deleteSousTache:p}=function(e){let[r,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[o,c]=(0,a.useState)(null),l=(0,a.useCallback)(async()=>{try{n(!0),c(null);let r=await x.getByTache(e);t(r)}catch(e){c(e instanceof Error?e:Error("Une erreur est survenue"))}finally{n(!1)}},[e]);(0,a.useEffect)(()=>{l()},[l]);let i=async(e,r)=>{try{let s=await x.update(e,r);return t(r=>r.map(r=>r.id===e?s:r)),f.oR.success("Sous-t\xe2che mise \xe0 jour avec succ\xe8s"),s}catch(e){throw e}},d=async(e,r)=>i(e,{completed:r});return{sousTaches:r,isLoading:s,error:o,refresh:l,createSousTache:async r=>{try{let s=await x.create({titre:r,tacheId:e});return t(e=>[...e,s]),f.oR.success("Sous-t\xe2che cr\xe9\xe9e avec succ\xe8s"),s}catch(e){throw e}},updateSousTache:i,deleteSousTache:async e=>{try{await x.delete(e),t(r=>r.filter(r=>r.id!==e)),f.oR.success("Sous-t\xe2che supprim\xe9e avec succ\xe8s")}catch(e){throw e}},toggleSousTache:d}}(r),m=async()=>{if(t.trim())try{await d(t.trim()),o("")}catch(e){console.error("Erreur lors de la cr\xe9ation de la sous-t\xe2che:",e)}};return l?(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(y,{})}):i?(0,s.jsx)("div",{className:"text-red-500 p-4",children:"Une erreur est survenue lors du chargement des sous-t\xe2ches"}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(h,{value:t,onChange:e=>o(e.target.value),placeholder:"Nouvelle sous-t\xe2che...",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),m())}}),(0,s.jsx)(E,{type:"button",variant:"outline",size:"icon",onClick:m,children:(0,s.jsx)(C.A,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",children:[(0,s.jsx)(w,{checked:e.completed,onCheckedChange:r=>u(e.id,r)}),(0,s.jsx)("span",{className:"flex-1 ".concat(e.completed?"line-through text-gray-500":""),children:e.titre}),(0,s.jsx)(E,{type:"button",variant:"ghost",size:"icon",onClick:()=>p(e.id),className:"h-8 w-8 text-gray-500 hover:text-red-500",children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})]},e.id))})]})};function S(e){let{className:r,children:t,...a}=e;return(0,s.jsx)("div",{className:i("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a,children:t})}function R(){let[e,r]=(0,a.useState)([]),[t]=(0,a.useState)(1);return(0,s.jsxs)("div",{className:"container mx-auto p-4 space-y-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Test des composants"}),(0,s.jsxs)(S,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test des Tags"}),(0,s.jsx)(v,{selectedTags:e,onTagsChange:r,placeholder:"Ajouter des tags de test..."}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Tags s\xe9lectionn\xe9s: ",e.join(", ")]})})]}),(0,s.jsxs)(S,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test des Sous-t\xe2ches"}),(0,s.jsx)(T,{tacheId:t}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["ID de la t\xe2che parent: ",t]})})]})]})}a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:i("flex flex-col space-y-1.5 p-6",t),...a})}).displayName="CardHeader",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:i("text-2xl font-semibold leading-none tracking-tight",t),...a})}).displayName="CardTitle",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:i("text-sm text-muted-foreground",t),...a})}).displayName="CardDescription",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:i("p-6 pt-0",t),...a})}).displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:i("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},7991:(e,r,t)=>{Promise.resolve().then(t.bind(t,72))}},e=>{var r=r=>e(e.s=r);e.O(0,[407,441,684,358],()=>r(7991)),_N_E=e.O()}]);