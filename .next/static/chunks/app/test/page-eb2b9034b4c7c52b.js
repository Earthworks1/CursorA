(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{7991:(e,r,t)=>{Promise.resolve().then(t.bind(t,9124))},9124:(e,r,t)=>{"use strict";t.d(r,{default:()=>D});var s=t(5155),a=t(2115),n=t(7192),o=t(7202),i=t(5572),c=t(9160);function l(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,c.QP)((0,i.$)(r))}let d=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:l(d({variant:t}),r),...a})}let h=a.forwardRef((e,r)=>{let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:l("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n})});h.displayName="Input";var m=t(1643),f=t(5837),p=t(9303),g=t(3039);let y={getByTache:async e=>{try{let r=await fetch("/api/sous-taches?tacheId=".concat(e));return v(r)}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des sous-t\xe2ches:",e),g.oR.error("Impossible de r\xe9cup\xe9rer les sous-t\xe2ches"),e}},create:async e=>{try{let r=await fetch("/api/sous-taches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return v(r)}catch(e){throw console.error("Erreur lors de la cr\xe9ation de la sous-t\xe2che:",e),g.oR.error("Impossible de cr\xe9er la sous-t\xe2che"),e}},update:async(e,r)=>{try{let t=await fetch("/api/sous-taches?id=".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return v(t)}catch(e){throw console.error("Erreur lors de la mise \xe0 jour de la sous-t\xe2che:",e),g.oR.error("Impossible de mettre \xe0 jour la sous-t\xe2che"),e}},delete:async e=>{try{let r=await fetch("/api/sous-taches?id=".concat(e),{method:"DELETE"});return v(r)}catch(e){throw console.error("Erreur lors de la suppression de la sous-t\xe2che:",e),g.oR.error("Impossible de supprimer la sous-t\xe2che"),e}}};t(5702),t(1530);class x extends Error{constructor(e,r,t){super(r),this.status=e,this.data=t,this.name="APIError"}}async function v(e){if(!e.ok){let r;try{r=await e.json()}catch(t){r={error:e.statusText||"Une erreur inconnue est survenue"}}throw new x(e.status,r.error||"Une erreur est survenue",r.details)}if(204!==e.status)try{return await e.json()}catch(e){throw new x(500,"Erreur lors de la lecture de la r\xe9ponse",e)}}let b={getAll:async()=>{try{let e=await fetch("/api/tags");return v(e)}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des tags:",e),g.oR.error("Impossible de r\xe9cup\xe9rer les tags"),e}},create:async e=>{try{let r=await fetch("/api/tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return v(r)}catch(e){throw console.error("Erreur lors de la cr\xe9ation du tag:",e),g.oR.error("Impossible de cr\xe9er le tag"),e}},delete:async e=>{try{let r=await fetch("/api/tags?id=".concat(e),{method:"DELETE"});return v(r)}catch(e){throw console.error("Erreur lors de la suppression du tag:",e),g.oR.error("Impossible de supprimer le tag"),e}}};function j(e){let{className:r,size:t="md"}=e;return(0,s.jsx)("div",{className:l("animate-spin rounded-full border-2 border-current border-t-transparent",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[t],r)})}let w=e=>{let{selectedTags:r=[],onTagsChange:t,placeholder:o="Ajouter un tag...",maxTags:i=10}=e,[c,l]=(0,a.useState)(""),{tags:d,isLoading:y,error:x,createTag:v}=function(){let e=(0,m.jE)(),{data:r,isLoading:t,error:s}=(0,f.I)({queryKey:["tags"],queryFn:b.getAll}),a=(0,p.n)({mutationFn:b.create,onSuccess:()=>{e.invalidateQueries({queryKey:["tags"]})}}),n=(0,p.n)({mutationFn:b.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["tags"]})}});return{tags:r,isLoading:t,error:s,createTag:async e=>{try{let r=await a.mutateAsync(e);return g.oR.success("Tag cr\xe9\xe9 avec succ\xe8s"),r}catch(e){throw e}},deleteTag:async e=>{try{await n.mutateAsync(e),g.oR.success("Tag supprim\xe9 avec succ\xe8s")}catch(e){throw e}},isCreating:a.isPending,isDeleting:n.isPending}}(),w=(null!=d?d:[]).filter(e=>r.includes(e.id)),N=async e=>{"Enter"===e.key||","===e.key?(e.preventDefault(),await k()):"Backspace"===e.key&&!c&&r.length>0&&C(r[r.length-1])},k=async()=>{let e=c.trim().toLowerCase();if(!e||r.length>=i)return;let s=(null!=d?d:[]).find(r=>r.nom.toLowerCase()===e);try{if(s)r.includes(s.id)||t([...r,s.id]);else{let s=await v({nom:e});t([...r,s.id])}l("")}catch(e){console.error("Erreur lors de la cr\xe9ation du tag:",e)}},C=e=>{t(r.filter(r=>r!==e))};return y?(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(j,{})}):x?(0,s.jsx)("div",{className:"text-red-500 p-4",children:"Une erreur est survenue lors du chargement des tags"}):(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:w.map(e=>(0,s.jsxs)(u,{variant:"secondary",className:"flex items-center gap-1 px-2 py-1",style:e.couleur?{backgroundColor:e.couleur}:void 0,children:[e.nom,(0,s.jsx)("button",{type:"button",onClick:()=>C(e.id),className:"hover:text-destructive",children:(0,s.jsx)(n.A,{className:"h-3 w-3"})})]},e.id))}),(0,s.jsx)(h,{type:"text",value:c,onChange:e=>l(e.target.value),onKeyDown:N,onBlur:()=>k(),placeholder:r.length<i?o:"Nombre maximum de tags atteint",disabled:r.length>=i,className:"w-full"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Appuyez sur Entr\xe9e ou utilisez une virgule pour ajouter un tag"})]})};var N=t(6336),k=t(1684);let C=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(N.bL,{ref:r,className:l("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,s.jsx)(N.C1,{className:l("flex items-center justify-center text-current"),children:(0,s.jsx)(k.A,{className:"h-4 w-4"})})})});C.displayName=N.bL.displayName;var E=t(5868);let T=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),S=a.forwardRef((e,r)=>{let{className:t,variant:a,size:n,asChild:o=!1,...i}=e,c=o?E.DX:"button";return(0,s.jsx)(c,{className:l(T({variant:a,size:n,className:t})),ref:r,...i})});S.displayName="Button";var R=t(3184);let A=e=>{let{tacheId:r}=e,[t,o]=(0,a.useState)(""),{sousTaches:i,isLoading:c,error:l,createSousTache:d,toggleSousTache:u,deleteSousTache:x}=function(e){let r=(0,m.jE)(),{data:t,isLoading:s,error:a}=(0,f.I)({queryKey:["sous-taches",e],queryFn:()=>y.getByTache(e)}),n=(0,p.n)({mutationFn:y.create,onSuccess:()=>{r.invalidateQueries({queryKey:["sous-taches",e]})}}),o=(0,p.n)({mutationFn:e=>{let{id:r,updates:t}=e;return y.update(r,t)},onSuccess:()=>{r.invalidateQueries({queryKey:["sous-taches",e]})}}),i=(0,p.n)({mutationFn:y.delete,onSuccess:()=>{r.invalidateQueries({queryKey:["sous-taches",e]})}}),c=async(e,r)=>{try{let t=await y.update(e,r);return g.oR.success("Sous-t\xe2che mise \xe0 jour avec succ\xe8s"),t}catch(e){throw e}},l=async(e,r)=>c(e,{completed:r});return{sousTaches:t,isLoading:s,error:a,createSousTache:n.mutate,updateSousTache:o.mutate,deleteSousTache:i.mutate,isCreating:n.isPending,isUpdating:o.isPending,isDeleting:i.isPending,toggleSousTache:l}}(r),v=async()=>{if(t.trim())try{await d({titre:t.trim(),tacheId:r}),o("")}catch(e){console.error("Erreur lors de la cr\xe9ation de la sous-t\xe2che:",e)}};return c?(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(j,{})}):l?(0,s.jsx)("div",{className:"text-red-500 p-4",children:"Une erreur est survenue lors du chargement des sous-t\xe2ches"}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(h,{value:t,onChange:e=>o(e.target.value),placeholder:"Nouvelle sous-t\xe2che...",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),v())}}),(0,s.jsx)(S,{type:"button",variant:"outline",size:"icon",onClick:v,children:(0,s.jsx)(R.A,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"space-y-2",children:(null!=i?i:[]).map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",children:[(0,s.jsx)(C,{checked:e.completed,onCheckedChange:r=>u(e.id,r)}),(0,s.jsx)("span",{className:"flex-1 ".concat(e.completed?"line-through text-gray-500":""),children:e.titre}),(0,s.jsx)(S,{type:"button",variant:"ghost",size:"icon",onClick:()=>x(e.id),className:"h-8 w-8 text-gray-500 hover:text-red-500",children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})]},e.id))})]})};function I(e){let{className:r,children:t,...a}=e;return(0,s.jsx)("div",{className:l("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a,children:t})}function D(){let[e,r]=(0,a.useState)([]),[t]=(0,a.useState)(1);return(0,s.jsxs)("div",{className:"container mx-auto p-4 space-y-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Test des composants"}),(0,s.jsxs)(I,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test des Tags"}),(0,s.jsx)(w,{selectedTags:e,onTagsChange:r,placeholder:"Ajouter des tags de test..."}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Tags s\xe9lectionn\xe9s: ",e.join(", ")]})})]}),(0,s.jsxs)(I,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test des Sous-t\xe2ches"}),(0,s.jsx)(A,{tacheId:t}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["ID de la t\xe2che parent: ",t]})})]})]})}a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:l("flex flex-col space-y-1.5 p-6",t),...a})}).displayName="CardHeader",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:l("text-2xl font-semibold leading-none tracking-tight",t),...a})}).displayName="CardTitle",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:l("text-sm text-muted-foreground",t),...a})}).displayName="CardDescription",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:l("p-6 pt-0",t),...a})}).displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:l("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"}},e=>{var r=r=>e(e.s=r);e.O(0,[499,441,684,358],()=>r(7991)),_N_E=e.O()}]);